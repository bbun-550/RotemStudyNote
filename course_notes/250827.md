250827

## 어제 과제 리뷰

- 앞으로 다항회귀

#### 4번 문제
- train, test data 나눠서 분석한다.
- 모델을 pickle로 저장해서 불러온다.

- 객체 만들어졌나, 안 만들어졌나 확인 

#### 5번 문제
- 모델 평가할 때 r2_score 말고도 MAE, MSE, RMSE, explained_variance_score도 보자.
- 정규화도 해볼 수 있다.

---

#### 비선형회귀분석
>통계기초.pdf 페이지68
- 비선형회귀란 직선의 회귀선보다 더 정확하게 데이터 변화를 예측하는 데 목적이 있다.

- 항을 추가하면 된다.

>실습파일
>[[lm14_nonlinear.py]] : 비선형회귀분석 PolynomialFeatures
>[[lm15_nonlinear.py]] : 
>- 시각화로 먼저 보고, 선형으로 할지/ 비선형으로 할지 선택한다.
>[[lm16_boston.py]]보스턴 집값 데이터(LSTAT 독립 : 모집단의 하위계층의 비율 - MEDV 종속 : 주택가격)

## 로지스틱 회귀분석
- 두 데이터 요인 간의 관계를 찾는 데이터 분석 기법이다.
- 독립변수는 연속형, 종속변수는 범주형이다.
- 이항분포이다. 이진 분류

- 인공지능, 기계학습에서 중요한 기법이다

- 마지막에 범주형으로 출력될 수 있게 시그모이 함수를 쓴다.
	- $f(x)=\frac{1}{1+e^{-(wx+b)}}$
- 로지스틱 회귀 분석은 수학에서 로지스틱 함수 또는 로짓 함수를 x와 y 사이의 방정식으로 사용하는 통계 모델이다. 로짓 함수는 y를 x의 시그모이드 함수로 매핑한다.
	- 로짓? 
	- 로짓 모델은 실패 대비 성공 비율 또는 로그 확률
	- odds ratio
	- $\text{Logit Funcion}=log(\frac{p}{1-p}$ => 시그모이함수가 나온다.
- [카페-Logistic Regression](https://cafe.daum.net/flowlife/SBU0/16?svc=toprank)
- [카페 - 확률과 가능도](https://cafe.daum.net/flowlife/SBU0/67?svc=toprank)
- [카페 - 확률과 가능도와 함수에 관한 기본 이해](https://cafe.daum.net/flowlife/SBU0/70?svc=toprank)
	- 확률, 가능도 개념도 알아야한다.[여기](https://cafe.daum.net/flowlife/SBU0/70?svc=toprank)
	- 확률 이해 => 가능도 이해 => 로그 씌워서 운영하는 우도 likelyhood 를 알 수 있다.
	- [영상 참고 자료](https://www.youtube.com/watch?v=j7Gbkc-l3Ao)
	- 최대 우도 추정법(Maximum Likelihood Estimation) : 여러 시그모이함수 나왔을 때 어떻게 선택할 것인지

#### 로지스틱 함수
- 음의 무한대부터 양의 무한대까지의 실수값을 0부터 1사이의 실수값으로 1 대 1 대응시키는 시그모이드함수다.
- $y=wx+b$는 -무한대~무한대 범위를 가질 수 있기 때문에 0,1으로 바꿔줘야 한다.
	1. odds ratio=μ1−μ $\frac{p}{1-p}$
	2. z=logit(odds ratio)=log(μ1−μ) [무슨 일 일어나는지 읽어볼 자료](https://recipesds.tistory.com/entry/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%A5%BC-%EB%A1%9C%EA%B7%B8-%EB%B3%80%ED%99%98-%ED%96%88%EC%9D%84-%EB%95%8C-%EB%B2%8C%EC%96%B4%EC%A7%80%EB%8A%94-%EC%9D%BC%EA%B3%BC-%EA%B2%B0%EA%B3%BC-%ED%95%B4%EC%84%9D)
	- 로짓 함수의 값은 로그 변환에 의해 음의 무한대(−∞−∞)부터 양의 무한대(∞∞)까지의 값을 가질 수 있다. 로지스틱 함수(Logistic function)는 로짓 함수의 역함수이다. 즉 음의 무한대(−∞)부터 양의 무한대(∞)까지의 값을 가지는 입력변수를 0부터 1사이의 값을 가지는 출력변수로 변환한 것이다.
	- logitstic(z) = μ(z) = 1+exp(−z)
- 오즈 odds : 성공 확률을 실패확률로 나눈 값
	- 오즈를 쓰는 이유는?
	- 비율로 비교하기 쉽다.
		- 몇 배나 더 가능성이 높은지를 직관적으로 설명할 수 있다
	- 수학적으로 다루기 편하다
		- 오즈에 로그를 취한 값 :arrow-right 로그오즈(log-odds)는 −∞부터 +∞ 사이의 값을 가진다
		- 이렇게 하면 선형회귀 같은 방법을 그대로 쓸 수 있다. 그래서 로지스틱에서 오즈를 쓴다.
- 다항분류 일 때는 시그모이드함수를 쓸 수 없다. 여러 개로 나눌 때는 softmax 함수
- 시그모이드 원리 수식 $S(x)=\frac{1}{1+e^{-x}}&)

- (결론) 로지스틱 회귀에서 wx+b로 얻은 값(로짓)은 −∞부터 +∞ 사이의 값이다. 이를 sigmoid 함수에 넣으면 값이 0~1 사이의 확률값으로 변환된다. 이 확률값을 기준(일반적으로 0.5)으로 0 또는 1 클래스로 분류할 수 있다

- 확률값들은 모두 곱하면 우도.


- 모델(시그모이함수로 도출됨)에서 누가 제일 좋은 녀석이야? 가 '우도' 

- 로지스틱 회귀에서는 확률을 곱한 Likelihood 대신, 그것에 log를 취한 Log-Likelihood를 사용하고, 실제로는 부호를 바꾼 손실 함수(Loss)를 최소화하여 학습한다

단계별로 요약 설명하면
 단계설명
① wx + b → 시그모이드 함수 → 확률 출력
② 확률을 가지고 각 샘플의 가능도 계산
③ 전체 데이터에 대한 가능도 함수 정의
④ 계산 편의를 위해 로그 가능도 사용
⑤ 로그 가능도의 부호를 반전시켜 손실 함수 (Log Loss) 정의
⑥ 이 손실을 최소화하여 최적의 w, b를 학습과 같다.

>실습파일(분류 classification)
>[[logi01.py]] : 로지스틱 회귀분석


